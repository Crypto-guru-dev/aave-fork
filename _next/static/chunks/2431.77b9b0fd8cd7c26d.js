"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[2431],{75158:function(e,r,t){t.d(r,{Z:function(){return O}});var n=t(63366),a=t(87462),o=t(67294),s=t(86010),i=t(94780),c=t(41796),u=t(37743),l=t(54235),d=t(85893),p=(0,l.Z)((0,d.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),m=(0,l.Z)((0,d.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),h=(0,l.Z)((0,d.jsx)("path",{d:"M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10H7v-2h10v2z"}),"IndeterminateCheckBox"),f=t(36622),v=t(78884),x=t(81719),y=t(34867);function g(e){return(0,y.Z)("MuiCheckbox",e)}var A=(0,t(1588).Z)("MuiCheckbox",["root","checked","disabled","indeterminate","colorPrimary","colorSecondary"]);const b=["checkedIcon","color","icon","indeterminate","indeterminateIcon","inputProps","size","className"],T=(0,x.ZP)(u.Z,{shouldForwardProp:e=>(0,x.FO)(e)||"classes"===e,name:"MuiCheckbox",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:t}=e;return[r.root,t.indeterminate&&r.indeterminate,"default"!==t.color&&r[`color${(0,f.Z)(t.color)}`]]}})((({theme:e,ownerState:r})=>(0,a.Z)({color:(e.vars||e).palette.text.secondary},!r.disableRipple&&{"&:hover":{backgroundColor:e.vars?`rgba(${"default"===r.color?e.vars.palette.action.activeChannel:e.vars.palette.primary.mainChannel} / ${e.vars.palette.action.hoverOpacity})`:(0,c.Fq)("default"===r.color?e.palette.action.active:e.palette[r.color].main,e.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:"transparent"}}},"default"!==r.color&&{[`&.${A.checked}, &.${A.indeterminate}`]:{color:(e.vars||e).palette[r.color].main},[`&.${A.disabled}`]:{color:(e.vars||e).palette.action.disabled}}))),w=(0,d.jsx)(m,{}),S=(0,d.jsx)(p,{}),k=(0,d.jsx)(h,{});var O=o.forwardRef((function(e,r){var t,c;const u=(0,v.Z)({props:e,name:"MuiCheckbox"}),{checkedIcon:l=w,color:p="primary",icon:m=S,indeterminate:h=!1,indeterminateIcon:x=k,inputProps:y,size:A="medium",className:O}=u,I=(0,n.Z)(u,b),C=h?x:m,j=h?x:l,E=(0,a.Z)({},u,{color:p,indeterminate:h,size:A}),R=(e=>{const{classes:r,indeterminate:t,color:n}=e,o={root:["root",t&&"indeterminate",`color${(0,f.Z)(n)}`]},s=(0,i.Z)(o,g,r);return(0,a.Z)({},r,s)})(E);return(0,d.jsx)(T,(0,a.Z)({type:"checkbox",inputProps:(0,a.Z)({"data-indeterminate":h},y),icon:o.cloneElement(C,{fontSize:null!=(t=C.props.fontSize)?t:A}),checkedIcon:o.cloneElement(j,{fontSize:null!=(c=j.props.fontSize)?c:A}),ownerState:E,ref:r,className:(0,s.default)(R.root,O)},I,{classes:R}))}))},96046:function(e,r,t){t.r(r),t.d(r,{WithdrawModal:function(){return We}});var n=t(59499),a=t(49501),o=t(67294),s=t(47130),i=t(8195),c=t(46930),u=t(63206),l=t(31959),d=t(94635),p=t(90116),m=t(1279);var h=o.forwardRef((function(e,r){return o.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor","aria-hidden":"true",ref:r},e),o.createElement("path",{fillRule:"evenodd",d:"M16.707 10.293a1 1 0 010 1.414l-6 6a1 1 0 01-1.414 0l-6-6a1 1 0 111.414-1.414L9 14.586V3a1 1 0 012 0v11.586l4.293-4.293a1 1 0 011.414 0z",clipRule:"evenodd"}))})),f=t(61953),v=t(81645),x=t(29630),y=t(9144),g=t(75158),A=t(25935),b=t(41024),T=t(72667),w=t(69331),S=t(46839),k=t(74119),O=t(30313),I=t(39051),C=t(71691),j=t(25808),E=t(77537),R=t(20301),W=t(78371),D=t(68448),_=t(57609),L=t(87385),P=t(53601),H=t(67916),M=t(20644),N=t(70794),B=function(e,r,t){var n=(0,m.hE)((null===r||void 0===r?void 0:r.underlyingBalance)||"0"),a=(0,m.hE)(t.unborrowedLiquidity),o=N.Z.min(n,a),s=(0,m.hE)("0"),i=e.isInEmode&&e.userEmodeCategoryId===t.eModeCategoryId?t.formattedEModeLiquidationThreshold:t.formattedReserveLiquidationThreshold;if(null!==r&&void 0!==r&&r.usageAsCollateralEnabledOnUser&&"0"!==t.reserveLiquidationThreshold&&"0"!==e.totalBorrowsMarketReferenceCurrency){var c=(0,m.hE)(e.healthFactor).minus("1.01");c.gt("0")&&(s=c.multipliedBy(e.totalBorrowsMarketReferenceCurrency).div(i)),o=N.Z.min(o,s.dividedBy(t.formattedPriceInMarketReferenceCurrency))}return o},Z=t(50029),U=t(17674),q=t(87794),F=t.n(q),Y=t(75331),z=t(24243),V=t(80854),G=t(85945),Q=t(56371),K=t(89291),$=t(32113),X=t(39771),J=t(31001),ee=t(67489),re=t(94671),te=t(85893);function ne(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ne(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ne(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var oe=function(e){var r=e.amountToSwap,t=e.amountToReceive,n=e.isWrongNetwork,s=e.sx,c=e.poolReserve,u=e.targetReserve,l=e.isMaxSelected,d=e.loading,p=e.blocked,m=e.buildTxFn,h=(0,W.Y)((function(e){return[e.withdrawAndSwitch,e.currentMarketData,e.jsonRpcProvider,e.account,e.generateApproval,e.estimateGasLimit,e.walletApprovalMethodPreference,e.generateSignatureRequest,e.addTransaction,e.trackEvent]})),f=(0,U.Z)(h,10),v=f[0],x=f[1],y=f[2],g=f[3],A=f[4],b=f[5],T=f[6],w=f[7],S=f[8],O=f[9],I=(0,i.vR)(),C=I.approvalTxState,j=I.mainTxState,R=I.loadingTxns,D=I.setMainTxState,L=I.setTxError,P=I.setGasLimit,H=I.setLoadingTxns,M=I.setApprovalTxState,N=(0,E.Z)(),B=N.sendTx,q=N.signTxData,ne=(0,G.NL)(),oe=(0,o.useState)(void 0),se=oe[0],ie=oe[1],ce=(0,o.useState)(),ue=ce[0],le=ce[1],de=(0,o.useMemo)((function(){return void 0!==se&&-1!==se&&"0"!==r&&!n&&se<=Number(r)}),[se,r,n]),pe=T===$.n.PERMIT,me=function(){var e=(0,Z.Z)(F().mark((function e(){var n,a,o,s,i;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,D(ae(ae({},j),{},{loading:!0})),e.next=4,m();case 4:return n=e.sent,a=v({poolReserve:c,targetReserve:u,isMaxSelected:l,amountToSwap:(0,Q.parseUnits)(r,c.decimals).toString(),amountToReceive:(0,Q.parseUnits)(t,u.decimals).toString(),augustus:n.augustus,txCalldata:n.swapCallData,signatureParams:ue}),e.next=8,b(a);case 8:return o=e.sent,e.next=11,B(o);case 11:return s=e.sent,e.next=14,s.wait(1);case 14:ne.invalidateQueries({queryKey:J.B.pool}),ne.invalidateQueries({queryKey:J.B.gho}),D({txHash:s.hash,loading:!1,success:!0}),S(s.hash,{action:Y.UQ.withdrawAndSwitch,txState:"success",asset:c.underlyingAsset,amount:(0,Q.parseUnits)(n.inputAmount,c.decimals).toString(),assetName:c.name,outAsset:u.underlyingAsset,outAssetName:u.name,outAmount:(0,Q.parseUnits)(n.outputAmount,u.decimals).toString()}),e.next=26;break;case 20:e.prev=20,e.t0=e.catch(0),i=(0,X.WG)(e.t0,X.aD.GAS_ESTIMATION,!1),L(i),D({txHash:void 0,loading:!1}),O(_.vh.TRANSACTION_ERROR,{transactiontype:Y.UQ.withdrawAndSwitch,asset:c.underlyingAsset,assetName:c.name,error:e.t0});case 26:case"end":return e.stop()}}),e,null,[[0,20]])})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=(0,Z.Z)(F().mark((function e(){var t,n,a,o,s,i,u,l,d;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(t=(0,k.sm)(r,c.decimals),n={user:g,token:c.aTokenAddress,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||"",amount:t},e.prev=2,!pe){e.next=16;break}return a=Math.floor(Date.now()/1e3+3600).toString(),e.next=7,w(ae(ae({},n),{},{deadline:a}));case 7:return o=e.sent,M(ae(ae({},C),{},{loading:!0})),e.next=11,q(o);case 11:s=e.sent,le({signature:s,deadline:a,amount:t}),M({txHash:K.Z,loading:!1,success:!0}),e.next=30;break;case 16:return i=A(n),e.next=19,b(i);case 19:return u=e.sent,M(ae(ae({},C),{},{loading:!0})),e.next=23,B(u);case 23:return l=e.sent,e.next=26,l.wait(1);case 26:M({txHash:l.hash,loading:!1,success:!0}),S(l.hash,{action:Y.UQ.withdrawAndSwitch,txState:"success",asset:c.aTokenAddress,amount:(0,Q.parseUnits)(t,c.decimals).toString(),assetName:"a".concat(c.symbol),spender:x.addresses.WITHDRAW_SWITCH_ADAPTER}),L(void 0),fe(c.aTokenAddress);case 30:e.next=37;break;case 32:e.prev=32,e.t0=e.catch(2),d=(0,X.WG)(e.t0,X.aD.GAS_ESTIMATION,!1),L(d),C.success||M({txHash:void 0,loading:!1});case 37:case"end":return e.stop()}}),e,null,[[2,32]])})));return function(){return e.apply(this,arguments)}}(),fe=(0,o.useCallback)(function(){var e=(0,Z.Z)(F().mark((function e(r){var t,n,a;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return H(!0),t=y(),n=new z.A(t),e.next=5,n.approvedAmount({user:g,token:r,spender:x.addresses.WITHDRAW_SWITCH_ADAPTER||""});case 5:a=e.sent,ie(a),H(!1);case 8:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),[y,g,x.addresses.WITHDRAW_SWITCH_ADAPTER,H]);return(0,o.useEffect)((function(){fe(c.aTokenAddress)}),[fe,c.aTokenAddress]),(0,o.useEffect)((function(){var e=0;e=Number(V.eB[Y.UQ.withdrawAndSwitch].recommended),de&&!C.success&&(e+=Number(re.pQ)),P(e.toString())}),[de,C,P]),(0,te.jsx)(ee.B,{mainTxState:j,approvalTxState:C,isWrongNetwork:n,preparingTransactions:R,handleAction:me,requiresAmount:!0,amount:r,handleApproval:function(){return he()},requiresApproval:de,actionText:(0,te.jsx)(a.cC,{id:"Withdraw and Switch"}),actionInProgressText:(0,te.jsx)(a.cC,{id:"Withdrawing and Switching"}),sx:s,errorParams:{loading:!1,disabled:p||!(null!==C&&void 0!==C&&C.success),content:(0,te.jsx)(a.cC,{id:"Withdraw and Switch"}),handleClick:me},fetchingData:d,blocked:p,tryPermit:!0})},se=t(71335),ie=t(55200),ce=function(e){var r=e.txHash,t=e.amount,n=e.symbol,o=e.outAmount,s=e.outSymbol;return(0,te.jsx)(ie.R,{txHash:r,children:(0,te.jsxs)(f.Z,{sx:{mt:2,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",textAlign:"center"},children:[(0,te.jsx)(x.Z,{children:(0,te.jsx)(a.cC,{id:"You've successfully withdrew & switched tokens."})}),(0,te.jsxs)(f.Z,{sx:{display:"flex",alignItems:"center",gap:2,mt:3},children:[(0,te.jsx)(T.T1,{sx:{fontSize:"20px"},symbol:n}),(0,te.jsx)(b.B,{value:Number(t),compact:!0,variant:"main14"}),(0,te.jsx)(x.Z,{variant:"secondary14",children:n}),(0,te.jsx)(v.Z,{sx:{fontSize:"14px"},children:(0,te.jsx)(se.Z,{fontSize:"14px"})}),(0,te.jsx)(T.T1,{sx:{fontSize:"20px"},symbol:s}),(0,te.jsx)(b.B,{value:Number(o),variant:"main14"}),(0,te.jsx)(x.Z,{variant:"secondary14",children:s})]})]})})},ue=t(21046),le=t(28744),de=t(93591),pe=t(5991);function me(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function he(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?me(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):me(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}var fe,ve=function(e){var r=e.poolReserve,t=e.amountToWithdraw,n=e.isWrongNetwork,s=e.tokenWrapperAddress,c=e.sx,u=e.blocked,l=(0,W.Y)((function(e){return[e.account,e.estimateGasLimit,e.walletApprovalMethodPreference,e.account,e.currentMarketData]})),d=(0,U.Z)(l,5),p=d[0],m=d[1],h=d[2],f=d[3],v=d[4],x=(0,E.Z)().sendTx,y=(0,G.NL)(),g=(0,o.useState)(),A=g[0],b=g[1],T=(0,i.vR)(),w=T.approvalTxState,S=T.mainTxState,k=T.loadingTxns,O=T.setLoadingTxns,I=T.setApprovalTxState,C=T.setMainTxState,j=T.setGasLimit,R=T.setTxError,D=(0,pe.z)().tokenWrapperService,_=(0,de.i)({chainId:v.chainId,token:r.aTokenAddress,spender:s}),L=_.data,P=_.isFetching,H=_.refetch;O(P);var M=!1;void 0!==L&&(M=(0,re.iv)({approvedAmount:L.toString(),amount:t,signedAmount:A?A.amount:"0"}));var N=h===$.n.PERMIT,B=(0,le.M)({usePermit:N,approvedAmount:{amount:(null===L||void 0===L?void 0:L.toString())||"0",spender:s,token:r.aTokenAddress,user:f},requiresApproval:M,assetAddress:r.aTokenAddress,symbol:r.symbol,decimals:r.decimals,signatureAmount:t,onApprovalTxConfirmed:H,onSignTxCompleted:function(e){return b(e)}}).approval,q=function(){var e=(0,Z.Z)(F().mark((function e(){var n,a,o,i,c;return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,C(he(he({},S),{},{loading:!0})),a="-1"===t?ue.Bz.toString():(0,V.gU)(t,r.decimals),!N||!A){e.next=17;break}return e.next=6,D.withdrawWrappedTokenWithPermit(a,s,f,A.deadline,A.signature);case 6:return o=e.sent,e.next=9,m(o);case 9:return o=e.sent,e.next=12,x(o);case 12:return n=e.sent,e.next=15,n.wait(1);case 15:e.next=28;break;case 17:return e.next=19,D.withdrawWrappedToken(a,s,p);case 19:return i=e.sent,e.next=22,m(i);case 22:return i=e.sent,e.next=25,x(i);case 25:return n=e.sent,e.next=28,n.wait(1);case 28:C({txHash:n.hash,loading:!1,success:!0}),y.invalidateQueries({queryKey:J.B.pool}),y.invalidateQueries({queryKey:J.B.approvedAmount(f,r.aTokenAddress,s,v.chainId)}),e.next=38;break;case 33:e.prev=33,e.t0=e.catch(0),c=(0,X.WG)(e.t0,X.aD.GAS_ESTIMATION,!1),R(c),I({txHash:void 0,loading:!1});case 38:case"end":return e.stop()}}),e,null,[[0,33]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=0;e=Number(V.eB[Y.UQ.withdraw].recommended),M&&!w.success&&(e+=Number(re.pQ)),j(e.toString())}),[M,w,N,j]),(0,te.jsx)(ee.B,{blocked:u,preparingTransactions:k,approvalTxState:w,mainTxState:S,amount:t,isWrongNetwork:n,requiresAmount:!0,actionInProgressText:(0,te.jsx)(a.cC,{id:"Withdrawing"}),actionText:(0,te.jsx)(a.cC,{id:"Withdraw"}),handleAction:q,requiresApproval:M,handleApproval:B,sx:c,tryPermit:!0})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(fe||(fe={}));var xe,ye=function(e){var r,t=e.assetsBlockingWithdraw,o=e.poolReserve,s=e.healthFactorAfterWithdraw,c=e.withdrawAmount,u=e.user,l=(0,i.vR)().mainTxState,d=void 0,p=(0,m.hE)(o.unborrowedLiquidity);l.success||l.txHash||(t.length>0&&!t.includes(o.symbol)?d=fe.ZERO_LTV_WITHDRAW_BLOCKED:s.lt("1")&&"0"!==u.totalBorrowsMarketReferenceCurrency?d=fe.CAN_NOT_WITHDRAW_THIS_AMOUNT:d||!p.eq("0")&&!(0,m.hE)(c).gt(o.unborrowedLiquidity)||(d=fe.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY));var h=(r={},(0,n.Z)(r,fe.CAN_NOT_WITHDRAW_THIS_AMOUNT,(0,te.jsx)(a.cC,{id:"You can not withdraw this amount because it will cause collateral call"})),(0,n.Z)(r,fe.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY,(0,te.jsx)(a.cC,{id:"These funds have been borrowed and are not available for withdrawal at this time."})),(0,n.Z)(r,fe.ZERO_LTV_WITHDRAW_BLOCKED,(0,te.jsx)(a.cC,{id:"Assets with zero LTV ({0}) must be withdrawn or disabled as collateral to perform this action",values:{0:t.join(", ")}})),r);return{blockingError:d,errorComponent:d?h[d]:null}};function ge(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Ae(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?ge(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ge(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(xe||(xe={}));var be,Te=function(e){var r=e.poolReserve,t=e.userReserve,n=e.symbol,s=e.isWrongNetwork,u=e.user,l=(0,i.vR)(),d=l.gasLimit,N=l.mainTxState,Z=l.txError,U=(0,E.Z)().currentAccount,q=(0,S.HT)().reserves,F=(0,c.f)(),Y=F.currentNetworkConfig,z=F.currentChainId,V=(0,C.P)(),G=(0,o.useState)(""),Q=G[0],K=G[1],$=(0,o.useState)(!1),X=$[0],J=$[1],ee=(0,o.useRef)(""),re=(0,W.Y)((function(e){return e.trackEvent})),ne=(0,o.useState)("0.1"),ae=ne[0],se=ne[1],ie=q.filter((function(e){return e.underlyingAsset!==r.underlyingAsset})).map((function(e){return{address:e.underlyingAsset,symbol:e.symbol,iconSymbol:e.iconSymbol}}));ie=[].concat((0,p.Z)(ie.filter((function(e){return"GHO"===e.symbol}))),(0,p.Z)(ie.filter((function(e){return"GHO"!==e.symbol}))));var ue=(0,o.useState)(ie[0]),le=ue[0],de=ue[1],pe="-1"===Q,me=u.userReservesData.find((function(e){return e.underlyingAsset===le.address})),he=B(u,t,r),fe=(0,m.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),xe=!1,ge=V.find((function(e){return e.tokenOut.underlyingAsset===r.underlyingAsset}));ge&&(xe=le.address===ge.tokenIn.underlyingAsset);var be=(0,I.E)(ee.current,r.decimals,(null===ge||void 0===ge?void 0:ge.tokenWrapperAddress)||""),Te=be.data,we=be.isFetching,Se=(0,O.k)({chainId:Y.underlyingChainId||z,userAddress:U,swapIn:Ae(Ae({},r),{},{amount:ee.current}),swapOut:Ae(Ae({},me.reserve),{},{amount:"0"}),max:pe&&he.eq(fe),skip:xe||N.loading||!1,maxSlippage:Number(ae)}),ke=Se.inputAmountUSD,Oe=Se.inputAmount,Ie=Se.outputAmount,Ce=Se.outputAmountUSD,je=Se.error,Ee=Se.loading,Re=Se.buildTxFn,We=Ce;xe&&(We=(0,m.hE)(Te||"0").multipliedBy((null===ge||void 0===ge?void 0:ge.tokenIn.priceInUSD)||0).toString());var De=Ee&&"0"===Ce||xe&&we,_e=(0,m.hE)(r.unborrowedLiquidity),Le=(0,j.W)(),Pe=pe?he.toString(10):Q,He=(0,D.DX)({user:u,userReserve:t,poolReserve:r,withdrawAmount:Pe}),Me=ye({assetsBlockingWithdraw:Le,poolReserve:r,healthFactorAfterWithdraw:He,withdrawAmount:Pe,user:u}),Ne=Me.blockingError,Be=Me.errorComponent,Ze=He.toNumber()>=1&&He.toNumber()<1.5&&t.usageAsCollateralEnabledOnUser,Ue=(0,m.hE)(Pe).multipliedBy((null===t||void 0===t?void 0:t.reserve.priceInUSD)||0),qe=(0,k.IG)(Ie,ae,me.reserve.decimals);if(N.success){var Fe=Oe,Ye=qe;return xe&&(Fe=ee.current,Ye=Te||"0"),(0,te.jsx)(ce,{txHash:N.txHash,amount:Fe,symbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.symbol,outSymbol:le.symbol,outAmount:Ye})}return(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(P.W,{inputTitle:(0,te.jsx)(a.cC,{id:"Withdraw"}),value:Pe,onChange:function(e){var t="-1"===e,n=(0,L.$w)(e,r.decimals);ee.current=t?he.toString(10):n,K(n),t&&he.eq(fe)&&re(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"})},symbol:n,assets:[{balance:he.toString(10),symbol:n,iconSymbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.iconSymbol}],usdValue:Ue.toString(10),isMaxSelected:pe,disabled:N.loading,maxValue:he.toString(10),balanceText:_e.lt(fe)?(0,te.jsx)(a.cC,{id:"Available"}):(0,te.jsx)(a.cC,{id:"Supply balance"})}),(0,te.jsxs)(f.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,te.jsx)(v.Z,{sx:{fontSize:"18px !important"},children:(0,te.jsx)(h,{})}),(0,te.jsx)(A.B,{loading:De,outputAmountUSD:Ce,inputAmountUSD:ke})]}),(0,te.jsx)(P.W,{value:xe?Te||"":Ie,onSelect:de,usdValue:We,symbol:le.symbol,assets:ie,inputTitle:(0,te.jsx)(a.cC,{id:"Receive (est.)"}),balanceText:(0,te.jsx)(a.cC,{id:"Supply balance"}),disableInput:!0,loading:De}),je&&!De&&!xe&&(0,te.jsx)(x.Z,{variant:"helperText",color:"error.main",children:je}),void 0!==Ne&&(0,te.jsx)(x.Z,{variant:"helperText",color:"error.main",children:Be}),(0,te.jsxs)(M.m6,{gasLimit:d,slippageSelector:xe?null:(0,te.jsx)(R.n,{selectedSlippage:ae,setSlippage:se,slippageTooltipHeader:(0,te.jsxs)(y.Z,{direction:"row",gap:2,alignItems:"center",justifyContent:"space-between",children:[(0,te.jsx)(a.cC,{id:"Minimum amount received"}),(0,te.jsx)(y.Z,{alignItems:"end",children:(0,te.jsxs)(y.Z,{direction:"row",children:[(0,te.jsx)(T.T1,{symbol:me.reserve.iconSymbol,sx:{mr:1,fontSize:"14px"}}),(0,te.jsx)(b.B,{value:qe,variant:"secondary12"})]})})]})}),children:[(0,te.jsx)(M.oD,{description:(0,te.jsx)(a.cC,{id:"Remaining supply"}),value:fe.minus(Pe||"0").toString(10),symbol:r.isWrappedBaseAsset?Y.baseAssetSymbol:r.symbol}),(0,te.jsx)(M.jz,{visibleHfChange:!!Q,healthFactor:u?u.healthFactor:"-1",futureHealthFactor:He.toString(10)})]}),Z&&(0,te.jsx)(H.Q,{txError:Z}),Ze&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(w.v,{severity:"error",sx:{my:6},children:(0,te.jsx)(a.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,te.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,te.jsx)(g.Z,{checked:X,onChange:function(){J(!X),re(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:X})},size:"small","data-cy":"risk-checkbox"}),(0,te.jsx)(x.Z,{variant:"description",children:(0,te.jsx)(a.cC,{id:"I acknowledge the risks involved."})})]})]}),xe?(0,te.jsx)(ve,{poolReserve:r,amountToWithdraw:ee.current,isWrongNetwork:s,tokenWrapperAddress:(null===ge||void 0===ge?void 0:ge.tokenWrapperAddress)||"",sx:Ze?{mt:0}:{},blocked:void 0!==Ne||Ze&&!X}):(0,te.jsx)(oe,{poolReserve:r,targetReserve:me.reserve,amountToSwap:Oe,amountToReceive:qe,isMaxSelected:pe&&he.eq(fe),isWrongNetwork:s,blocked:void 0!==Ne||Ze&&!X,buildTxFn:Re,sx:Ze?{mt:0}:{}})]})},we=t(93608),Se=function(e){var r=e.poolReserve,t=e.amountToWithdraw,n=e.poolAddress,o=e.isWrongNetwork,s=e.symbol,i=e.blocked,c=e.sx,u=(0,W.Y)((function(e){return e.withdraw})),l=(0,K.Q)({tryPermit:!1,handleGetTxns:function(){var e=(0,Z.Z)(F().mark((function e(){return F().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",u({reserve:n,amount:t,aTokenAddress:r.aTokenAddress}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),skip:!t||0===parseFloat(t)||i,deps:[t,n],eventTxInfo:{amount:t,assetName:r.name,asset:r.underlyingAsset},protocolAction:Y.UQ.withdraw}),d=l.action,p=l.loadingTxns,m=l.mainTxState,h=l.approvalTxState,f=l.approval,v=l.requiresApproval;return(0,te.jsx)(ee.B,{blocked:i,preparingTransactions:p,approvalTxState:h,mainTxState:m,amount:t,isWrongNetwork:o,requiresAmount:!0,actionInProgressText:(0,te.jsx)(a.cC,{id:"Withdrawing {symbol}",values:{symbol:s}}),actionText:(0,te.jsx)(a.cC,{id:"Withdraw {symbol}",values:{symbol:s}}),handleAction:d,handleApproval:function(){return f([{amount:t,underlyingAsset:n}])},requiresApproval:v,sx:c})};!function(e){e[e.CAN_NOT_WITHDRAW_THIS_AMOUNT=0]="CAN_NOT_WITHDRAW_THIS_AMOUNT",e[e.POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY=1]="POOL_DOES_NOT_HAVE_ENOUGH_LIQUIDITY",e[e.ZERO_LTV_WITHDRAW_BLOCKED=2]="ZERO_LTV_WITHDRAW_BLOCKED"}(be||(be={}));var ke,Oe=function(e){var r=e.poolReserve,t=e.userReserve,n=e.unwrap,s=e.setUnwrap,u=e.symbol,l=e.isWrongNetwork,d=e.user,p=(0,i.vR)(),h=p.gasLimit,v=p.mainTxState,y=p.txError,A=(0,c.f)().currentNetworkConfig,b=(0,o.useState)(""),T=b[0],S=b[1],k=(0,o.useState)(""),O=k[0],I=k[1],C=(0,o.useState)(!1),E=C[0],R=C[1],L=(0,o.useRef)(""),N=(0,W.Y)((function(e){return e.trackEvent})),Z="-1"===T,U=B(d,t,r),q=(0,m.hE)((null===t||void 0===t?void 0:t.underlyingBalance)||"0"),F=(0,m.hE)(r.unborrowedLiquidity),Y=Z?U.toString(10):T,z=(0,j.W)(),G=(0,D.DX)({user:d,userReserve:t,poolReserve:r,withdrawAmount:Y}),Q=ye({assetsBlockingWithdraw:z,poolReserve:r,healthFactorAfterWithdraw:G,withdrawAmount:Y,user:d}),K=Q.blockingError,$=Q.errorComponent,X=G.toNumber()>=1&&G.toNumber()<1.5&&t.usageAsCollateralEnabledOnUser,J=(0,m.hE)(Y).multipliedBy((null===t||void 0===t?void 0:t.reserve.priceInUSD)||0);return v.success?(0,te.jsx)(we.R,{action:(0,te.jsx)(a.cC,{id:"withdrew"}),amount:L.current,symbol:n&&r.isWrappedBaseAsset?A.baseAssetSymbol:r.symbol}):(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(P.W,{value:Y,onChange:function(e){var r="-1"===e;L.current=r?U.toString(10):e,S(e),r&&U.eq(q)?(N(_.vh.MAX_INPUT_SELECTION,{type:"withdraw"}),I("-1")):I(U.toString(10))},symbol:u,assets:[{balance:U.toString(10),symbol:u,iconSymbol:n&&r.isWrappedBaseAsset?A.baseAssetSymbol:r.iconSymbol}],usdValue:J.toString(10),isMaxSelected:Z,disabled:v.loading,maxValue:U.toString(10),balanceText:F.lt(q)?(0,te.jsx)(a.cC,{id:"Available"}):(0,te.jsx)(a.cC,{id:"Supply balance"})}),void 0!==K&&(0,te.jsx)(x.Z,{variant:"helperText",color:"error.main",children:$}),r.isWrappedBaseAsset&&(0,te.jsx)(M.Pu,{unwrapped:n,setUnWrapped:s,label:(0,te.jsx)(x.Z,{children:"Unwrap ".concat(r.symbol," (to withdraw ").concat(A.baseAssetSymbol,")")})}),(0,te.jsxs)(M.m6,{gasLimit:h,children:[(0,te.jsx)(M.oD,{description:(0,te.jsx)(a.cC,{id:"Remaining supply"}),value:q.minus(Y||"0").toString(10),symbol:r.isWrappedBaseAsset?A.baseAssetSymbol:r.symbol}),(0,te.jsx)(M.jz,{visibleHfChange:!!T,healthFactor:d?d.healthFactor:"-1",futureHealthFactor:G.toString(10)})]}),y&&(0,te.jsx)(H.Q,{txError:y}),X&&(0,te.jsxs)(te.Fragment,{children:[(0,te.jsx)(w.v,{severity:"error",sx:{my:6},children:(0,te.jsx)(a.cC,{id:"Withdrawing this amount will reduce your health factor and increase risk of liquidation."})}),(0,te.jsxs)(f.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"center",alignItems:"center",mx:"24px",mb:"12px"},children:[(0,te.jsx)(g.Z,{checked:E,onChange:function(){R(!E),N(_.vh.ACCEPT_RISK,{modal:"Withdraw",riskCheckboxAccepted:E})},size:"small","data-cy":"risk-checkbox"}),(0,te.jsx)(x.Z,{variant:"description",children:(0,te.jsx)(a.cC,{id:"I acknowledge the risks involved."})})]})]}),(0,te.jsx)(Se,{poolReserve:r,amountToWithdraw:Z?O:Y,poolAddress:n&&r.isWrappedBaseAsset?V.hP:r.underlyingAsset,isWrongNetwork:l,symbol:u,blocked:void 0!==K||X&&!E,sx:X?{mt:0}:{}})]})},Ie=t(34637),Ce=t(59379);function je(e){var r,t=e.withdrawType,n=e.setWithdrawType,o=(0,c.f)().currentMarketData,s=(0,W.Y)((function(e){return e.trackEvent}));return null!==(r=o.enabledFeatures)&&void 0!==r&&r.collateralRepay?(0,te.jsx)(f.Z,{sx:{mb:6},children:(0,te.jsxs)(Ce.f,{color:"primary",value:t,exclusive:!0,onChange:function(e,r){return n(r)},children:[(0,te.jsx)(Ie.Y,{value:ke.WITHDRAW,disabled:t===ke.WITHDRAW,onClick:function(){return s(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw"})},children:(0,te.jsx)(x.Z,{variant:"buttonM",children:(0,te.jsx)(a.cC,{id:"Withdraw"})})}),(0,te.jsx)(Ie.Y,{value:ke.WITHDRAWSWITCH,disabled:t===ke.WITHDRAWSWITCH,onClick:function(){return s(_.sj.SWITCH_WITHDRAW_TYPE,{withdrawType:"Withdraw and Switch"})},children:(0,te.jsx)(x.Z,{variant:"buttonM",children:(0,te.jsx)(a.cC,{id:"Withdraw & Switch"})})})]})}):null}function Ee(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),t.push.apply(t,n)}return t}function Re(e){for(var r=1;r<arguments.length;r++){var t=null!=arguments[r]?arguments[r]:{};r%2?Ee(Object(t),!0).forEach((function(r){(0,n.Z)(e,r,t[r])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ee(Object(t)).forEach((function(r){Object.defineProperty(e,r,Object.getOwnPropertyDescriptor(t,r))}))}return e}!function(e){e[e.WITHDRAW=0]="WITHDRAW",e[e.WITHDRAWSWITCH=1]="WITHDRAWSWITCH"}(ke||(ke={}));var We=function(){var e=(0,i.vR)(),r=e.type,t=e.close,n=e.args,p=e.mainTxState,m=(0,o.useState)(!0),h=m[0],f=m[1],v=(0,o.useState)(ke.WITHDRAW),x=v[0],y=v[1],g=(0,c.f)().currentMarketData,A=u.cr.withdrawAndSwitch(g);return(0,te.jsx)(l.P,{open:r===i.w8.Withdraw,setOpen:function(){y(ke.WITHDRAW),t()},children:(0,te.jsx)(d.A,{title:(0,te.jsx)(a.cC,{id:"Withdraw"}),underlyingAsset:n.underlyingAsset,keepWrappedSymbol:!h,children:function(e){return(0,te.jsx)(s.X,{children:function(r){return(0,te.jsxs)(te.Fragment,{children:[A&&!p.txHash&&(0,te.jsx)(je,{withdrawType:x,setWithdrawType:y}),x===ke.WITHDRAW&&(0,te.jsx)(Oe,Re(Re({},e),{},{unwrap:h,setUnwrap:f,user:r})),x===ke.WITHDRAWSWITCH&&(0,te.jsx)(te.Fragment,{children:(0,te.jsx)(Te,Re(Re({},e),{},{user:r}))})]})}})}})})}},30313:function(e,r,t){t.d(r,{k:function(){return u}});var n=t(50029),a=t(87794),o=t.n(a),s=t(1279),i=t(67294),c=t(74119),u=function(e){var r=e.chainId,t=e.max,a=e.maxSlippage,u=e.swapIn,l=e.swapOut,d=e.userAddress,p=e.skip,m=(0,i.useState)("0"),h=m[0],f=m[1],v=(0,i.useState)("0"),x=v[0],y=v[1],g=(0,i.useState)("0"),A=g[0],b=g[1],T=(0,i.useState)("0"),w=T[0],S=T[1],k=(0,i.useState)(),O=k[0],I=k[1],C=(0,i.useState)(!1),j=C[0],E=C[1],R=(0,i.useState)(""),W=R[0],D=R[1],_=(0,i.useMemo)((function(){return{underlyingAsset:u.underlyingAsset,decimals:u.decimals,supplyAPY:u.supplyAPY,amount:u.amount,variableBorrowAPY:u.variableBorrowAPY}}),[u.amount,u.decimals,u.supplyAPY,u.underlyingAsset,u.variableBorrowAPY]),L=(0,i.useMemo)((function(){return{underlyingAsset:l.underlyingAsset,decimals:l.decimals,supplyAPY:l.supplyAPY,amount:l.amount,variableBorrowAPY:l.variableBorrowAPY}}),[l.amount,l.decimals,l.supplyAPY,l.underlyingAsset,l.variableBorrowAPY]),P=(0,i.useCallback)((function(){return(0,c.F8)(_,L,r,d,t)}),[r,_,L,d,t]);return(0,i.useEffect)((function(){if(!p){var e=function(){var e=(0,n.Z)(o().mark((function e(){var r,t;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(_.underlyingAsset&&L.underlyingAsset&&_.amount&&"0"!==_.amount&&!isNaN(+_.amount)){e.next=7;break}return f("0"),b("0"),S("0"),y("0"),I(void 0),e.abrupt("return");case 7:return E(!0),e.prev=8,e.next=11,P();case 11:r=e.sent,D(""),I(r),f((0,s.Fv)(r.srcAmount,r.srcDecimals)),y(r.srcUSD),b((0,s.Fv)(r.destAmount,r.destDecimals)),S(r.destUSD),e.next=25;break;case 20:e.prev=20,e.t0=e.catch(8),console.error(e.t0),t=(0,c.aE)(e.t0.message),D(t);case 25:return e.prev=25,E(!1),e.finish(25);case 28:case"end":return e.stop()}}),e,null,[[8,20,25,28]])})));return function(){return e.apply(this,arguments)}}(),r=setTimeout((function(){e()}),400);return function(){clearTimeout(r)}}}),[W,p,_.underlyingAsset,L.underlyingAsset,P,a,_.amount,d,t]),{outputAmount:A,outputAmountUSD:w,inputAmount:h,inputAmountUSD:x,loading:j,error:W,buildTxFn:function(){var e=(0,n.Z)(o().mark((function e(){return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=2;break}throw new Error("Route required to build transaction");case 2:return e.abrupt("return",(0,c.xS)(O,u,l,r,d,a));case 3:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}},39051:function(e,r,t){t.d(r,{E:function(){return i},v:function(){return c}});var n=t(36492),a=t(2593),o=t(56371),s=t(5991),i=function(e,r,t){var i=(0,s.z)().tokenWrapperService;return(0,n.a)({queryFn:function(){return""===e||"0"===e?Promise.resolve(a.O$.from(0)):i.getTokenInForTokenOut((0,o.parseUnits)(e,r).toString(),t)},queryKey:["tokenInForTokenOut",t,e],select:function(e){return(0,o.formatUnits)(e.toString(),r)}})},c=function(e,r,t){var i=(0,s.z)().tokenWrapperService;return(0,n.a)({queryFn:function(){return""===e||"0"===e?Promise.resolve(a.O$.from(0)):i.getTokenOutForTokenIn((0,o.parseUnits)(e,r).toString(),t)},queryKey:["tokenOutForTokenIn",t,e],select:function(e){return(0,o.formatUnits)(e.toString(),r)}})}},71691:function(e,r,t){t.d(r,{P:function(){return d}});var n=t(59499),a=t(1279),o=t(3439),s=t(78371),i=t(51002),c=t(87385),u=t(46839),l=(0,n.Z)({},i.el.proto_mainnet_v3,[{tokenIn:o.ou.DAI.UNDERLYING.toLowerCase(),tokenOut:o.ou.sDAI.UNDERLYING.toLowerCase(),tokenWrapperContractAddress:o.zq}]),d=function(){var e,r=(0,u.HT)(),t=r.marketReferencePriceInUsd,n=r.marketReferenceCurrencyDecimals,o=r.reserves,i=(0,s.Y)((function(e){return e.currentMarket}));if(!o||0===o.length)return[];return(null!==(e=l[i])&&void 0!==e?e:[]).map((function(e){var r=o.find((function(r){return r.underlyingAsset===e.tokenIn})),s=o.find((function(r){return r.underlyingAsset===e.tokenOut}));if(!r||!s)throw new Error("wrapped token reserves not found");var i=(0,a.Fv)(r.priceInMarketReferenceCurrency,n),u=(0,a.Fv)(s.priceInMarketReferenceCurrency,n);return{tokenIn:{symbol:r.symbol,underlyingAsset:r.underlyingAsset,decimals:r.decimals,priceInUSD:(0,c.N4)(1,i,t).toString(),formattedPriceInMarketReferenceCurrency:i},tokenOut:{symbol:s.symbol,underlyingAsset:s.underlyingAsset,decimals:s.decimals,priceInUSD:(0,c.N4)(1,u,t).toString(),formattedPriceInMarketReferenceCurrency:u},tokenWrapperAddress:e.tokenWrapperContractAddress}}))}},25808:function(e,r,t){t.d(r,{W:function(){return o}});var n=t(78371),a=t(74570),o=function(){var e=(0,n.Y)((function(e){return e.currentMarketData})),r=(0,a.C)(e).data;if(!e.v3||!r)return[];var t=[];return r.userReservesData.forEach((function(e){Number(e.scaledATokenBalance)>0&&"0"===e.reserve.baseLTVasCollateral&&e.usageAsCollateralEnabledOnUser&&"0"!==e.reserve.reserveLiquidationThreshold&&t.push(e.reserve.symbol)})),t}},68448:function(e,r,t){t.d(r,{_S:function(){return s},bU:function(){return i},DX:function(){return c},$m:function(){return u}});var n=t(20854),a=t(1279),o=t(70794);function s(e){var r,t=e.fromAmount,o=e.fromAssetData,s=e.fromAssetUserData,i=e.toAmountAfterSlippage,c=e.toAssetData,u=e.user,l=u.isInEmode&&u.userEmodeCategoryId===o.eModeCategoryId?o.formattedEModeLiquidationThreshold:o.formattedReserveLiquidationThreshold,d="0";s.usageAsCollateralEnabledOnUser&&"0"!==o.reserveLiquidationThreshold&&(d=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(t).multipliedBy(o.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:u.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:l}).toString());var p="0";return(!u.isInIsolationMode&&!c.isIsolated||u.isInIsolationMode&&(null===(r=u.isolatedReserve)||void 0===r?void 0:r.underlyingAsset)===c.underlyingAsset)&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(i).multipliedBy(c.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:u.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:u.isInEmode&&u.userEmodeCategoryId===c.eModeCategoryId?c.formattedEModeLiquidationThreshold:c.formattedReserveLiquidationThreshold}).toString()),{hfEffectOfFromAmount:d,hfAfterSwap:"-1"===u.healthFactor?(0,a.hE)("-1"):(0,a.hE)(u.healthFactor).plus(p).minus(d)}}var i=function(e){var r=e.user,t=e.amountToReceiveAfterSwap,s=e.amountToSwap,i=e.fromAssetData,c=e.toAssetData,u=e.repayWithUserReserve,l=e.debt,d=r.isInEmode&&r.userEmodeCategoryId===i.eModeCategoryId?i.formattedEModeLiquidationThreshold:i.formattedReserveLiquidationThreshold,p="0";null!==u&&void 0!==u&&u.usageAsCollateralEnabledOnUser&&i.usageAsCollateralEnabled&&(p=(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(s).multipliedBy(i.formattedPriceInMarketReferenceCurrency),borrowBalanceMarketReferenceCurrency:r.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:d}).toString());var m=(0,a.hE)(o.Z.min(t,l)).multipliedBy(c.priceInUSD).toString(10),h=(0,a.hE)(r.totalBorrowsUSD).minus(m);h=o.Z.max(h,(0,a.hE)("0"));var f=(0,n.L1)({collateralBalanceMarketReferenceCurrency:r.totalCollateralUSD,borrowBalanceMarketReferenceCurrency:h.toString(10),currentLiquidationThreshold:r.currentLiquidationThreshold}),v="0"!==i.reserveLiquidationThreshold&&null!==u&&void 0!==u&&u.usageAsCollateralEnabledOnUser?(0,n.L1)({collateralBalanceMarketReferenceCurrency:(0,a.hE)(s).multipliedBy(i.priceInUSD),borrowBalanceMarketReferenceCurrency:h.toString(10),currentLiquidationThreshold:i.formattedReserveLiquidationThreshold}).toString():"0",x=f.eq(-1)?f:f.minus(v);return{hfEffectOfFromAmount:(0,a.hE)(p),hfAfterSwap:x.isLessThan(0)&&!x.eq(-1)?0:x}},c=function(e){var r=e.user,t=e.userReserve,s=e.poolReserve,i=e.withdrawAmount,c=(0,a.hE)(r.totalCollateralMarketReferenceCurrency),u=r.currentLiquidationThreshold,l=(0,a.hE)(r.healthFactor),d=r.isInEmode&&r.userEmodeCategoryId===s.eModeCategoryId?s.formattedEModeLiquidationThreshold:s.formattedReserveLiquidationThreshold;if(null!==t&&void 0!==t&&t.usageAsCollateralEnabledOnUser&&"0"!==s.reserveLiquidationThreshold){var p=(0,a.hE)(i).multipliedBy(s.formattedPriceInMarketReferenceCurrency);c=c.minus(p),u=(0,a.hE)(r.totalCollateralMarketReferenceCurrency).multipliedBy((0,a.hE)(r.currentLiquidationThreshold)).minus((0,a.hE)(p).multipliedBy(d)).div(c).toFixed(4,o.Z.ROUND_DOWN),l=(0,n.L1)({collateralBalanceMarketReferenceCurrency:c,borrowBalanceMarketReferenceCurrency:r.totalBorrowsMarketReferenceCurrency,currentLiquidationThreshold:u})}return l},u=function(e,r,t){var o,s=e?(0,a.hE)(e.healthFactor):"-1",i=e?(0,a.hE)(e.totalCollateralMarketReferenceCurrency).plus(t):"-1",c=e?(0,a.hE)(e.totalCollateralMarketReferenceCurrency).multipliedBy(e.currentLiquidationThreshold).plus(t.multipliedBy(r.formattedReserveLiquidationThreshold)).dividedBy(i):"-1";return e&&(!e.isInIsolationMode&&!r.isIsolated||e.isInIsolationMode&&(null===(o=e.isolatedReserve)||void 0===o?void 0:o.underlyingAsset)===r.underlyingAsset)&&(s=(0,n.L1)({collateralBalanceMarketReferenceCurrency:i,borrowBalanceMarketReferenceCurrency:(0,a.hE)(e.totalBorrowsMarketReferenceCurrency),currentLiquidationThreshold:c})),s}},71335:function(e,r,t){var n=t(67294);const a=n.forwardRef((function(e,r){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:r},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M14 5l7 7m0 0l-7 7m7-7H3"}))}));r.Z=a}}]);
"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1811],{81811:function(e,t,r){r.r(t),r.d(t,{RepayModal:function(){return Ae}});var n=r(59499),a=r(49501),o=r(67294),s=r(47130),i=r(46839),l=r(8195),u=r(46930),c=r(63206),d=r(31959),p=r(94635),m=r(75331),y=r(1279),b=r(52358),f=r(61953),v=r(81645),x=r(29630),h=r(9144),g=r(70794),A=r(25935),S=r(41024),j=r(72667),T=r(74119),w=r(50029),O=r(87794),C=r.n(O),k=r(25808),E=r(77537),P=r(20301),R=r(68448),D=r(53601),B=r(93608),L=r(20644),N=r(94671),I=r(99730),U=r(17674),W=r(4730),Z=r(80854),_=r(21732),M=r(78371),F=r(67489),Y=r(85893),H=["repayAmount","poolReserve","fromAssetData","isWrongNetwork","sx","symbol","rateMode","repayAllDebt","useFlashLoan","blocked","loading","repayWithAmount","buildTxFn"];function V(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function q(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?V(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):V(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var Q=function(e){var t,r=e.repayAmount,n=e.poolReserve,o=e.fromAssetData,s=e.isWrongNetwork,i=e.sx,l=e.symbol,u=e.rateMode,c=e.repayAllDebt,d=e.useFlashLoan,p=e.blocked,y=e.loading,b=e.repayWithAmount,f=e.buildTxFn,v=(0,W.Z)(e,H),x=(0,M.Y)((function(e){return[e.paraswapRepayWithCollateral,e.currentMarketData]})),h=(0,U.Z)(x,2),g=h[0],A=h[1],S=(0,_.P)({protocolAction:m.UQ.repayCollateral,handleGetTxns:function(){var e=(0,w.Z)(C().mark((function e(t,a){var i;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,f();case 2:return i=e.sent,e.abrupt("return",g({repayAllDebt:c,repayAmount:r,rateMode:u,repayWithAmount:b,fromAssetData:o,poolReserve:n,isWrongNetwork:s,symbol:l,useFlashLoan:d,blocked:p,swapCallData:i.swapCallData,augustus:i.augustus,signature:t,deadline:a,signedAmount:(0,T.sm)(b,o.decimals)}));case 4:case"end":return e.stop()}}),e)})));return function(t,r){return e.apply(this,arguments)}}(),handleGetApprovalTxns:function(){var e=(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",g({repayAllDebt:c,repayAmount:r,rateMode:u,repayWithAmount:b,fromAssetData:o,poolReserve:n,isWrongNetwork:s,symbol:l,useFlashLoan:!1,blocked:p,swapCallData:"0x",augustus:Z.hP}));case 1:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}(),gasLimitRecommendation:Z.eB[m.UQ.repayCollateral].limit,skip:y||!r||0===parseFloat(r)||p,spender:null!==(t=A.addresses.REPAY_WITH_COLLATERAL_ADAPTER)&&void 0!==t?t:"",deps:[o.symbol,b]}),j=S.approval,O=S.action,k=S.loadingTxns,E=S.approvalTxState,P=S.mainTxState,R=S.requiresApproval;return(0,Y.jsx)(F.B,q(q({preparingTransactions:k,mainTxState:P,approvalTxState:E,requiresAmount:!0,amount:r,requiresApproval:R,isWrongNetwork:s,blocked:p,sx:i},v),{},{handleAction:O,handleApproval:function(){return j({amount:(0,T.sm)(b,o.decimals),underlyingAsset:o.aTokenAddress})},actionText:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:l}}),actionInProgressText:(0,Y.jsx)(a.cC,{id:"Repaying {symbol}",values:{symbol:l}}),fetchingData:y,errorParams:{loading:!1,disabled:p,content:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:l}}),handleClick:O},tryPermit:!0}))};function G(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?G(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):G(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}function K(e){var t=e.poolReserve,r=e.symbol,n=e.debtType,s=e.userReserve,c=e.isWrongNetwork,d=e.user,p=(0,i.HT)(),O=p.reserves,U=p.userReserves,W=(0,l.vR)(),Z=W.gasLimit,_=W.txError,M=W.mainTxState,F=(0,u.f)(),H=F.currentChainId,V=F.currentNetworkConfig,q=(0,E.Z)().currentAccount,G=d.userReservesData.filter((function(e){return"0"!==e.underlyingBalance&&e.underlyingAsset!==t.underlyingAsset&&"stETH"!==e.reserve.symbol})).map((function(e){return{address:e.underlyingAsset,balance:e.underlyingBalance,balanceUSD:e.underlyingBalanceUSD,symbol:e.reserve.symbol,iconSymbol:e.reserve.iconSymbol,decimals:e.reserve.decimals}})).sort((function(e,t){return Number(t.balanceUSD)-Number(e.balanceUSD)})),K=(0,o.useState)(G[0]),X=K[0],J=K[1],$=X.balance||"0",ee="exactOut",te=(0,o.useState)(""),re=te[0],ne=te[1],ae=(0,o.useState)("0.5"),oe=ae[0],se=ae[1],ie=(0,o.useRef)(""),le=O.find((function(e){return e.underlyingAsset===X.address})),ue=n===m.tk.Stable?(null===s||void 0===s?void 0:s.stableBorrows)||"0":(null===s||void 0===s?void 0:s.variableBorrows)||"0",ce=(0,y.hE)(ue);ce=ce.plus(ce.multipliedBy(t.variableBorrowAPY).dividedBy(17280));var de="-1"===re,pe=de?ce.toString():re,me=(0,y.hE)(pe).multipliedBy(t.priceInUSD).toString(),ye=ce.multipliedBy(t.priceInUSD).multipliedBy(100+Number(oe)).dividedBy(100).dividedBy(le.priceInUSD),be=z(z({},le),{},{amount:$}),fe=z(z({},t),{},{amount:ie.current}),ve=de&&(0,y.hE)($).gte(ye),xe=function(e){var t=e.chainId,r=e.max,n=e.maxSlippage,a=e.skip,s=e.swapIn,i=e.swapOut,l=e.userAddress,u=e.swapVariant,c=(0,o.useState)("0"),d=c[0],p=c[1],m=(0,o.useState)("0"),b=m[0],f=m[1],v=(0,o.useState)("0"),x=v[0],h=v[1],g=(0,o.useState)("0"),A=g[0],S=g[1],j=(0,o.useState)(),O=j[0],k=j[1],E=(0,o.useState)(!1),P=E[0],R=E[1],D=(0,o.useState)(""),B=D[0],L=D[1],N=(0,o.useMemo)((function(){return{underlyingAsset:s.underlyingAsset,decimals:s.decimals,supplyAPY:s.supplyAPY,amount:s.amount,variableBorrowAPY:s.variableBorrowAPY}}),[s.amount,s.decimals,s.supplyAPY,s.underlyingAsset,s.variableBorrowAPY]),I=(0,o.useMemo)((function(){return{underlyingAsset:i.underlyingAsset,decimals:i.decimals,supplyAPY:i.supplyAPY,amount:i.amount,variableBorrowAPY:i.variableBorrowAPY}}),[i.amount,i.decimals,i.supplyAPY,i.underlyingAsset,i.variableBorrowAPY]),U=(0,o.useCallback)((function(){return(0,T.F8)(N,I,t,l)}),[t,N,I,l]),W=(0,o.useCallback)((function(){return(0,T.wP)(N,I,t,l,r)}),[t,r,N,I,l]);return(0,o.useEffect)((function(){if(!a){var e=function(){var e=(0,w.Z)(C().mark((function e(){var t,r;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(N.underlyingAsset&&I.underlyingAsset&&("exactIn"!==u||N.amount&&"0"!==N.amount&&!isNaN(+N.amount))&&("exactOut"!==u||I.amount&&"0"!==I.amount&&!isNaN(+I.amount))){e.next=7;break}return p("0"),f("0"),h("0"),S("0"),k(void 0),e.abrupt("return");case 7:if(R(!0),e.prev=8,"exactIn"!==u){e.next=15;break}return e.next=12,U();case 12:t=e.sent,e.next=18;break;case 15:return e.next=17,W();case 17:t=e.sent;case 18:L(""),k(t),p((0,y.Fv)(t.srcAmount,t.srcDecimals)),h((0,y.Fv)(t.destAmount,t.destDecimals)),f(t.srcUSD),S(t.destUSD),e.next=31;break;case 26:e.prev=26,e.t0=e.catch(8),console.error(e.t0),r=(0,T.aE)(e.t0.message),L(r);case 31:return e.prev=31,R(!1),e.finish(31);case 34:case"end":return e.stop()}}),e,null,[[8,26,31,34]])})));return function(){return e.apply(this,arguments)}}(),t=setTimeout((function(){e()}),400);return function(){clearTimeout(t)}}}),[a,u,N.underlyingAsset,N.amount,I.underlyingAsset,I.amount,U,W,n]),{outputAmount:x,outputAmountUSD:A,inputAmount:d,inputAmountUSD:b,loading:P,error:B,buildTxFn:function(){var e=(0,w.Z)(C().mark((function e(){return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(O){e.next=2;break}throw new Error("Route required to build transaction");case 2:if("exactIn"!==u){e.next=6;break}return e.abrupt("return",(0,T.xS)(O,s,i,t,l,n));case 6:return e.abrupt("return",(0,T._n)(O,s,i,t,l,n));case 7:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}()}}({chainId:V.underlyingChainId||H,userAddress:q,swapVariant:ee,swapIn:be,swapOut:fe,max:ve,skip:M.loading||!1,maxSlippage:Number(oe)}),he=xe.inputAmountUSD,ge=xe.inputAmount,Ae=xe.outputAmount,Se=xe.outputAmountUSD,je=xe.loading,Te=xe.error,we=xe.buildTxFn,Oe=je&&"0"===he,Ce=function(e){var t="-1"===e;ie.current=t?ce.toString(10):e,ne(e)},ke=U.find((function(e){return e.underlyingAsset===X.address})),Ee=(0,R.bU)({amountToReceiveAfterSwap:Ae,amountToSwap:ge,fromAssetData:le,user:d,toAssetData:t,repayWithUserReserve:ke,debt:ue}),Pe=Ee.hfAfterSwap,Re=Ee.hfEffectOfFromAmount,De=(0,N.gK)(d.healthFactor,Re.toString())||(null===le||void 0===le?void 0:le.isFrozen),Be=(0,y.hE)(ue).minus(g.Z.min(Ae,ue)),Le=Be.multipliedBy(t.priceInUSD),Ne=$?(0,y.hE)($).minus(ge):(0,y.hE)("0"),Ie=Ne.multipliedBy(le.priceInUSD),Ue=pe,We=me,Ze=(0,k.W)(),_e=void 0;Ze.length>0&&!Ze.includes(X.symbol)?_e=N.NI.ZERO_LTV_WITHDRAW_BLOCKED:(0,y.hE)($).lt(ge)?_e=N.NI.NOT_ENOUGH_COLLATERAL_TO_REPAY_WITH:De&&!le.flashLoanEnabled&&(_e=N.NI.FLASH_LOAN_NOT_AVAILABLE);var Me=function(){switch(_e){case N.NI.NOT_ENOUGH_COLLATERAL_TO_REPAY_WITH:return(0,Y.jsx)(a.cC,{id:"Not enough collateral to repay this amount of debt with"});case N.NI.ZERO_LTV_WITHDRAW_BLOCKED:return(0,Y.jsx)(a.cC,{id:"Assets with zero LTV ({0}) must be withdrawn or disabled as collateral to perform this action",values:{0:Ze.join(", ")}});case N.NI.FLASH_LOAN_NOT_AVAILABLE:return(0,Y.jsx)(a.cC,{id:"Due to health factor impact, a flashloan is required to perform this transaction, but Aave Governance has disabled flashloan availability for this asset. Try lowering the amount or supplying additional collateral."});default:return null}},Fe=(0,T.LN)(ge,oe,X.decimals||18);(0,T.IG)(Ae,oe,t.decimals);return M.success?(0,Y.jsx)(B.R,{action:(0,Y.jsx)(a.cC,{id:"Repaid"}),amount:Ae,symbol:t.symbol}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(D.W,{value:Ue,onChange:Ce,usdValue:We,symbol:t.symbol,assets:[{address:t.underlyingAsset,symbol:t.symbol,iconSymbol:t.iconSymbol,balance:ue}],isMaxSelected:de,maxValue:ue,inputTitle:(0,Y.jsx)(a.cC,{id:"Expected amount to repay"}),balanceText:(0,Y.jsx)(a.cC,{id:"Borrow balance"})}),(0,Y.jsxs)(f.Z,{sx:{padding:"18px",pt:"14px",display:"flex",justifyContent:"space-between"},children:[(0,Y.jsx)(v.Z,{sx:{fontSize:"18px !important"},children:(0,Y.jsx)(b.Z,{})}),(0,Y.jsx)(A.B,{loading:Oe,outputAmountUSD:Se,inputAmountUSD:he})]}),(0,Y.jsx)(D.W,{value:ge,usdValue:he,symbol:X.symbol,assets:G,onSelect:J,onChange:Ce,inputTitle:(0,Y.jsx)(a.cC,{id:"Collateral to repay with"}),balanceText:(0,Y.jsx)(a.cC,{id:"Borrow balance"}),maxValue:$,loading:Oe,disableInput:!0}),Te&&!Oe&&(0,Y.jsx)(x.Z,{variant:"helperText",color:"error.main",children:Te}),void 0!==_e&&(0,Y.jsx)(x.Z,{variant:"helperText",color:"error.main",children:(0,Y.jsx)(Me,{})}),(0,Y.jsxs)(L.m6,{gasLimit:Z,slippageSelector:(0,Y.jsx)(P.n,{selectedSlippage:oe,setSlippage:se,slippageTooltipHeader:(0,Y.jsx)(h.Z,{direction:"row",alignItems:"center",children:(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(a.cC,{id:"Maximum collateral amount to use"}),(0,Y.jsx)(h.Z,{alignItems:"end",children:(0,Y.jsxs)(h.Z,{direction:"row",children:[(0,Y.jsx)(j.T1,{symbol:X.iconSymbol||"",sx:{mr:1,fontSize:"14px"}}),(0,Y.jsx)(S.B,{value:Fe,variant:"secondary12"})]})})]})})}),children:[(0,Y.jsx)(L.jz,{visibleHfChange:!!re,healthFactor:null===d||void 0===d?void 0:d.healthFactor,futureHealthFactor:Pe.toString(10),loading:Oe}),(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Borrow balance after repay"}),futureValue:Be.toString(),futureValueUSD:Le.toString(),symbol:r,tokenIcon:t.iconSymbol,loading:Oe,hideSymbolSuffix:!0}),(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Collateral balance after repay"}),futureValue:Ne.toString(),futureValueUSD:Ie.toString(),symbol:X.symbol,tokenIcon:X.iconSymbol,loading:Oe,hideSymbolSuffix:!0})]}),_&&(0,Y.jsx)(I.f,{txError:_}),(0,Y.jsx)(Q,{poolReserve:t,fromAssetData:le,repayAmount:Ae,repayWithAmount:Fe,repayAllDebt:ve,useFlashLoan:De,isWrongNetwork:c,symbol:r,rateMode:n,blocked:void 0!==_e||""!==Te,loading:je,buildTxFn:we})]})}var X=r(84707),J=r(82403),$=r(20854),ee=r(69125),te=r(67916),re=r(85945),ne=r(56371),ae=r(28744),oe=r(93591),se=r(32113),ie=r(39771),le=r(31001),ue=["amountToRepay","poolReserve","poolAddress","isWrongNetwork","sx","symbol","debtType","repayWithATokens","blocked","maxApproveNeeded"];function ce(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function de(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?ce(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):ce(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var pe,me=function(e){var t=e.amountToRepay,r=e.poolReserve,n=e.poolAddress,s=e.isWrongNetwork,i=e.sx,u=e.symbol,c=e.debtType,d=e.repayWithATokens,p=e.blocked,y=e.maxApproveNeeded,b=(0,W.Z)(e,ue),f=(0,M.Y)((function(e){return[e.repay,e.repayWithPermit,e.encodeRepayParams,e.encodeRepayWithPermitParams,e.tryPermit,e.walletApprovalMethodPreference,e.estimateGasLimit,e.addTransaction,e.useOptimizedPath,e.currentMarketData]})),v=(0,U.Z)(f,10),x=v[0],h=v[1],g=v[2],A=v[3],S=v[4],j=v[5],T=v[6],O=v[7],k=v[8],P=v[9],R=(0,E.Z)().sendTx,D=(0,re.NL)(),B=(0,o.useState)(),L=B[0],I=B[1],_=(0,l.vR)(),H=_.approvalTxState,V=_.mainTxState,q=_.loadingTxns,Q=_.setMainTxState,G=_.setTxError,z=_.setGasLimit,K=_.setLoadingTxns,X=_.setApprovalTxState,J=(0,oe.y)(P,n),$=J.data,ee=J.refetch,te=J.isFetching,ce=J.isFetchedAfterMount,pe=S({reserveAddress:n,isWrappedBaseAsset:r.isWrappedBaseAsset}),me=pe&&j===se.n.PERMIT;K(te);var ye=!d&&0!==Number(t)&&(0,N.iv)({approvedAmount:(null===$||void 0===$?void 0:$.amount)||"0",amount:-1===Number(t)?y:t,signedAmount:L?L.amount:"0"});ye&&null!==H&&void 0!==H&&H.success&&X({});var be=(0,ae.M)({usePermit:me,approvedAmount:$,requiresApproval:ye,assetAddress:n,symbol:u,decimals:r.decimals,signatureAmount:t,onApprovalTxConfirmed:ee,onSignTxCompleted:function(e){return I(e)}}).approval;(0,o.useEffect)((function(){ce||d||ee()}),[ee,ce,d]);var fe=function(){var e=(0,w.Z)(C().mark((function e(){var a,o,s,i,l,p,y,b,f;return C().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,Q(de(de({},V),{},{loading:!0})),o=m.UQ.default,!me||!L){e.next=21;break}if(s={amount:"-1"===t?t:(0,ne.parseUnits)(t,r.decimals).toString(),reserve:n,interestRateMode:c,signature:L.signature,deadline:L.deadline},!k()){e.next=9;break}return e.next=8,A(s);case 8:i=e.sent;case 9:return o=m.UQ.repayWithPermit,l=h(de(de({},s),{},{encodedTxData:i?i[0]:void 0})),e.next=13,T(l);case 13:return l=e.sent,e.next=16,R(l);case 16:return a=e.sent,e.next=19,a.wait(1);case 19:e.next=36;break;case 21:if(p={amountToRepay:"-1"===t?t:(0,ne.parseUnits)(t,r.decimals).toString(),poolAddress:n,repayWithATokens:d,debtType:c},!k()){e.next=26;break}return e.next=25,g(p);case 25:y=e.sent;case 26:return o=m.UQ.repay,b=x(de(de({},p),{},{encodedTxData:y})),e.next=30,T(b);case 30:return b=e.sent,e.next=33,R(b);case 33:return a=e.sent,e.next=36,a.wait(1);case 36:Q({txHash:a.hash,loading:!1,success:!0}),O(a.hash,{action:o,txState:"success",asset:n,amount:t,assetName:u}),D.invalidateQueries({queryKey:le.B.pool}),D.invalidateQueries({queryKey:le.B.gho}),e.next=47;break;case 42:e.prev=42,e.t0=e.catch(0),f=(0,ie.WG)(e.t0,ie.aD.GAS_ESTIMATION,!1),G(f),Q({txHash:void 0,loading:!1});case 47:case"end":return e.stop()}}),e,null,[[0,42]])})));return function(){return e.apply(this,arguments)}}();return(0,o.useEffect)((function(){var e=0;me?e=Number(Z.eB[m.UQ.supplyWithPermit].recommended):(e=Number(Z.eB[m.UQ.supply].recommended),ye&&!H.success&&(e+=Number(N.pQ))),z(e.toString())}),[ye,H,me,z]),(0,Y.jsx)(F.B,de(de({blocked:p,preparingTransactions:q||!$,symbol:r.symbol,mainTxState:V,approvalTxState:H,requiresAmount:!0,amount:t,requiresApproval:ye,isWrongNetwork:s,sx:i},b),{},{handleAction:fe,handleApproval:be,actionText:(0,Y.jsx)(a.cC,{id:"Repay {symbol}",values:{symbol:u}}),actionInProgressText:(0,Y.jsx)(a.cC,{id:"Repaying {symbol}",values:{symbol:u}}),tryPermit:pe}))},ye=function(e){var t,r,n,s=e.poolReserve,d=e.userReserve,p=e.symbol,b=e.tokenBalance,f=e.nativeBalance,v=e.isWrongNetwork,h=e.debtType,A=e.user,S=(0,l.vR)(),j=S.gasLimit,T=S.mainTxState,w=S.txError,O=(0,i.HT)().marketReferencePriceInUsd,C=(0,u.f)(),k=C.currentChainId,E=C.currentMarketData,P=C.currentMarket,R=(0,M.Y)((function(e){return[e.poolComputed.minRemainingBaseTokenBalance]})),N=(0,U.Z)(R,1)[0],I=(0,o.useState)({address:s.underlyingAsset,symbol:s.symbol,iconSymbol:s.iconSymbol,balance:b}),W=I[0],_=I[1],F=(0,o.useState)([W]),H=F[0],V=F[1],q=(0,o.useState)(""),Q=q[0],G=q[1],z=(0,o.useState)(""),K=z[0],re=z[1],ne=(0,o.useRef)(),ae=(0,c.Mo)(k),oe=d.underlyingBalance,se=d.usageAsCollateralEnabledOnUser,ie=d.reserve,le=W.address===s.aTokenAddress,ue=h===m.tk.Stable?(null===d||void 0===d?void 0:d.stableBorrows)||"0":(null===d||void 0===d?void 0:d.variableBorrows)||"0",ce=new g.Z(ue).multipliedBy(s.formattedPriceInMarketReferenceCurrency).multipliedBy(O).shiftedBy(-J.$3),de=(0,y.hE)(ue).multipliedBy("1.0025").decimalPlaces(s.decimals,g.Z.ROUND_UP);if(le)r=g.Z.min(oe,ue),n=oe;else{var pe=(0,y.hE)(W.balance).minus((null===d||void 0===d?void 0:d.reserve.symbol.toUpperCase())===ae.baseAssetSymbol?N:"0");n=pe.toString(10),r=g.Z.min(pe,ue)}var ye="-1"===K,be=ye?r.toString(10):K;(0,o.useEffect)((function(){var e=[];if(s.symbol===ae.wrappedBaseAssetSymbol){var t=(0,y.hE)(f),r=g.Z.max(t,g.Z.min(t,ue));e.push({address:Z.hP.toLowerCase(),symbol:ae.baseAssetSymbol,balance:r.toString(10)})}var n=g.Z.min((0,y.hE)(b),ue),a=g.Z.max(n,b);if(e.push({address:s.underlyingAsset,symbol:s.symbol,iconSymbol:s.iconSymbol,balance:a.toString(10)}),E.v3&&!(0,ee.F$)({symbol:s.symbol,currentMarket:P})){var o=(0,y.hE)(oe),i=g.Z.max(o,g.Z.min(o,ue).toString(10));e.push({address:s.aTokenAddress,symbol:"a".concat(s.symbol),iconSymbol:s.iconSymbol,aToken:!0,balance:i.toString(10)})}V(e),_(e[0])}),[]);var fe=(0,y.hE)(ue).minus(be||"0").toString(10),ve=new g.Z(fe).multipliedBy(s.formattedPriceInMarketReferenceCurrency).multipliedBy(O).shiftedBy(-J.$3),xe=ye&&ve.toNumber()>0,he=null===A||void 0===A?void 0:A.healthFactor;if(be){var ge=(null===A||void 0===A?void 0:A.totalCollateralUSD)||"0";le&&se&&(ge=(0,y.hE)((null===A||void 0===A?void 0:A.totalCollateralUSD)||"0").minus((0,y.hE)(ie.priceInUSD).multipliedBy(be)));var Ae=(0,y.hE)((null===A||void 0===A?void 0:A.totalBorrowsUSD)||"0").minus((0,y.hE)(ie.priceInUSD).multipliedBy(be)),Se=g.Z.max(Ae,0),je=(0,$.L1)({collateralBalanceMarketReferenceCurrency:ge,borrowBalanceMarketReferenceCurrency:Se,currentLiquidationThreshold:(null===A||void 0===A?void 0:A.currentLiquidationThreshold)||"0"});he=je.isLessThan(0)&&!je.eq(-1)?"0":je.toString(10)}var Te=(0,y.hE)(be).multipliedBy(ie.priceInUSD);return T.success?(0,Y.jsx)(B.R,{action:(0,Y.jsx)(a.cC,{id:"repaid"}),amount:ne.current,symbol:le?s.symbol:W.symbol}):(0,Y.jsxs)(Y.Fragment,{children:[(0,Y.jsx)(D.W,{value:be,onChange:function(e){var t="-1"===e;ne.current=t?r.toString(10):e,re(e),t&&(le||r.eq(ue))?W.address===Z.hP.toLowerCase()||X.U[k]&&X.U[k].toLowerCase()===ie.underlyingAsset.toLowerCase()?G(de.toString(10)):G("-1"):G(de.lt(n)?de.toString(10):r.toString(10))},usdValue:Te.toString(10),symbol:W.symbol,assets:H,onSelect:_,isMaxSelected:ye,maxValue:r.toString(10),balanceText:(0,Y.jsx)(a.cC,{id:"Wallet balance"})}),xe&&(0,Y.jsx)(x.Z,{color:"warning.main",variant:"helperText",children:(0,Y.jsx)(a.cC,{id:"You don\u2019t have enough funds in your wallet to repay the full amount. If you proceed to repay with your current amount of funds, you will still have a small borrowing position in your dashboard."})}),(0,Y.jsxs)(L.m6,{gasLimit:j,children:[(0,Y.jsx)(L.XJ,{description:(0,Y.jsx)(a.cC,{id:"Remaining debt"}),futureValue:fe,futureValueUSD:ve.toString(10),value:ue,valueUSD:ce.toString(),symbol:s.iconSymbol===ae.wrappedBaseAssetSymbol?ae.baseAssetSymbol:s.iconSymbol}),(0,Y.jsx)(L.jz,{visibleHfChange:!!K,healthFactor:null===A||void 0===A?void 0:A.healthFactor,futureHealthFactor:he})]}),w&&(0,Y.jsx)(te.Q,{txError:w}),(0,Y.jsx)(me,{maxApproveNeeded:de.toString(),poolReserve:s,amountToRepay:ye?Q:be,poolAddress:le?s.underlyingAsset:null!==(t=W.address)&&void 0!==t?t:"",isWrongNetwork:v,symbol:p,debtType:h,repayWithATokens:le})]})},be=r(34637),fe=r(59379),ve=r(57609);function xe(e){var t,r=e.repayType,n=e.setRepayType,o=(0,u.f)().currentMarketData,s=(0,M.Y)((function(e){return e.trackEvent}));return null!==(t=o.enabledFeatures)&&void 0!==t&&t.collateralRepay?(0,Y.jsxs)(f.Z,{sx:{mb:6},children:[(0,Y.jsx)(x.Z,{mb:1,color:"text.secondary",children:(0,Y.jsx)(a.cC,{id:"Repay with"})}),(0,Y.jsxs)(fe.f,{color:"primary",value:r,exclusive:!0,onChange:function(e,t){return n(t)},children:[(0,Y.jsx)(be.Y,{value:pe.BALANCE,disabled:r===pe.BALANCE,onClick:function(){return s(ve.rQ.SWITCH_REPAY_TYPE,{repayType:"Wallet Balance"})},children:(0,Y.jsx)(x.Z,{variant:"buttonM",children:(0,Y.jsx)(a.cC,{id:"Wallet balance"})})}),(0,Y.jsx)(be.Y,{value:pe.COLLATERAL,disabled:r===pe.COLLATERAL,onClick:function(){return s(ve.rQ.SWITCH_REPAY_TYPE,{repayType:"Collateral"})},children:(0,Y.jsx)(x.Z,{variant:"buttonM",children:(0,Y.jsx)(a.cC,{id:"Collateral"})})})]})]}):null}function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ge(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(Object(r),!0).forEach((function(t){(0,n.Z)(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(Object(r)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}!function(e){e[e.BALANCE=0]="BALANCE",e[e.COLLATERAL=1]="COLLATERAL"}(pe||(pe={}));var Ae=function(){var e=(0,l.vR)(),t=e.type,r=e.close,n=e.args,m=e.mainTxState,y=(0,i.HT)().userReserves,b=(0,u.f)().currentMarketData,f=(0,o.useState)(pe.BALANCE),v=f[0],x=f[1],h=c.cr.collateralRepay(b)&&y.some((function(e){return"0"!==e.scaledATokenBalance&&e.underlyingAsset!==n.underlyingAsset}));return(0,Y.jsx)(d.P,{open:t===l.w8.Repay,setOpen:function(){x(pe.BALANCE),r()},children:(0,Y.jsx)(p.A,{title:(0,Y.jsx)(a.cC,{id:"Repay"}),underlyingAsset:n.underlyingAsset,children:function(e){return(0,Y.jsx)(s.X,{children:function(t){return(0,Y.jsxs)(Y.Fragment,{children:[h&&!m.txHash&&(0,Y.jsx)(xe,{repayType:v,setRepayType:x}),v===pe.BALANCE&&(0,Y.jsx)(ye,ge(ge({},e),{},{debtType:n.currentRateMode,user:t})),v===pe.COLLATERAL&&(0,Y.jsx)(K,ge(ge({},e),{},{debtType:n.currentRateMode,user:t}))]})}})}})})}},52358:function(e,t,r){var n=r(67294);const a=n.forwardRef((function(e,t){return n.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:2,stroke:"currentColor","aria-hidden":"true",ref:t},e),n.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M19 14l-7 7m0 0l-7-7m7 7V3"}))}));t.Z=a}}]);